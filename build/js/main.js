"use strict";

function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
(function (_sessionStorage$getIt, _Number) {
  var apiURL = 'https://fav-prom.com/api_lvlup_2025';
  var PROMO_START_DATE = new Date("2025-04-14T12:00:00");
  var currentDate = new Date();
  var weekDates = [];
  var weekNums = 0;
  var prizeFunds = ["300 000", "300 000", "400 000"];
  var formatDate = function formatDate(date) {
    return "".concat(date.getDate().toString().padStart(2, "0"), ".").concat((date.getMonth() + 1).toString().padStart(2, "0"));
  };
  for (var i = 0; i < 3; i++) {
    var start = new Date(PROMO_START_DATE.getTime() + i * 7 * 24 * 60 * 60 * 1000);
    var end = new Date(start.getTime() + 6 * 24 * 60 * 60 * 1000);
    end.setHours(23, 59, 59, 999);
    weekDates[i] = {
      start: start,
      end: end,
      period: "".concat(formatDate(start), " - ").concat(formatDate(end)),
      prizeFund: prizeFunds[i]
    };
    if (currentDate >= end) {
      weekNums++;
    }
  }
  for (var _i = 0; _i < weekDates.length; _i++) {
    if (currentDate >= weekDates[_i].start && currentDate <= weekDates[_i].end) {
      weekNums = _i + 1;
    }
  }
  if (weekNums === 0) {
    if (currentDate < weekDates[0].start) {
      console.log("Акція ще не почалась");
    } else {
      console.log("Акція вже закінчилась");
    }
  }
  console.log("Поточний тиждень:", weekNums);
  console.log("Деталі тижнів:", weekDates);
  var unauthMsgs = document.querySelectorAll('.unauth-msgs'),
    participateBtns = document.querySelectorAll('.took-part'),
    playBtns = document.querySelectorAll('.play-btn'),
    mainPage = document.querySelector(".fav-page"),
    tabsContainer = document.querySelector(".results__tabs"),
    weekAmount = document.querySelector(".results__prize-amount");
  var ukLeng = document.querySelector('#ukLeng');
  var enLeng = document.querySelector('#enLeng');
  var locale = (_sessionStorage$getIt = sessionStorage.getItem("locale")) !== null && _sessionStorage$getIt !== void 0 ? _sessionStorage$getIt : 'uk';
  // let locale =  'uk';

  if (ukLeng) locale = 'uk';
  if (enLeng) locale = 'en';
  var i18nData = {};
  var userId;
  var debug = false;
  userId = (_Number = Number(sessionStorage.getItem("userId"))) !== null && _Number !== void 0 ? _Number : 100300268;
  // userId = 100300268 ;

  var checkUserAuth = function checkUserAuth() {
    if (userId) {
      var _iterator = _createForOfIteratorHelper(unauthMsgs),
        _step;
      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var unauthMes = _step.value;
          unauthMes.classList.add('hide');
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
      request("/users").then(function (data) {
        var user = data.find(function (user) {
          return user.userid === userId;
        });
        if (user) {
          var _iterator2 = _createForOfIteratorHelper(playBtns),
            _step2;
          try {
            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
              var playBtn = _step2.value;
              playBtn.classList.remove('hide');
            }
          } catch (err) {
            _iterator2.e(err);
          } finally {
            _iterator2.f();
          }
          var _iterator3 = _createForOfIteratorHelper(participateBtns),
            _step3;
          try {
            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
              var participateBtn = _step3.value;
              participateBtn.classList.add('hide');
            }
          } catch (err) {
            _iterator3.e(err);
          } finally {
            _iterator3.f();
          }
        } else {
          var _iterator4 = _createForOfIteratorHelper(participateBtns),
            _step4;
          try {
            for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
              var _participateBtn = _step4.value;
              _participateBtn.classList.remove('hide');
            }
          } catch (err) {
            _iterator4.e(err);
          } finally {
            _iterator4.f();
          }
          var _iterator5 = _createForOfIteratorHelper(playBtns),
            _step5;
          try {
            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
              var _playBtn = _step5.value;
              _playBtn.classList.add('hide');
            }
          } catch (err) {
            _iterator5.e(err);
          } finally {
            _iterator5.f();
          }
        }
      });
    } else {
      var _iterator6 = _createForOfIteratorHelper(participateBtns),
        _step6;
      try {
        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
          var participateBtn = _step6.value;
          participateBtn.classList.add('hide');
        }
      } catch (err) {
        _iterator6.e(err);
      } finally {
        _iterator6.f();
      }
      var _iterator7 = _createForOfIteratorHelper(unauthMsgs),
        _step7;
      try {
        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
          var _unauthMes = _step7.value;
          _unauthMes.classList.remove('hide');
        }
      } catch (err) {
        _iterator7.e(err);
      } finally {
        _iterator7.f();
      }
    }
  };
  var InitPage = function InitPage() {
    checkUserAuth();
    translate();
    renderTabs(tabsContainer);
  };
  function participate() {
    if (!userId) {
      return;
    }
    var params = {
      userid: userId
    };
    console.log(params);
    fetch(apiURL + '/user/', {
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      method: 'POST',
      body: JSON.stringify(params)
    }).then(function (res) {
      return res.json();
    }).then(function (res) {
      var _iterator8 = _createForOfIteratorHelper(participateBtns),
        _step8;
      try {
        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
          var joinBtn = _step8.value;
          joinBtn.classList.add('hide');
        }
      } catch (err) {
        _iterator8.e(err);
      } finally {
        _iterator8.f();
      }
      InitPage();
    });
  }
  function loadTranslations() {
    return fetch("".concat(apiURL, "/new-translates/").concat(locale)).then(function (res) {
      return res.json();
    }).then(function (json) {
      i18nData = json;
      translate();
      var mutationObserver = new MutationObserver(function (mutations) {
        translate();
      });
      mutationObserver.observe(document.getElementById('lvlUp'), {
        childList: true,
        subtree: true
      });
    });
  }
  function translate() {
    var elems = document.querySelectorAll('[data-translate]');
    if (elems && elems.length) {
      if (!debug) {
        elems.forEach(function (elem) {
          var key = elem.getAttribute('data-translate');
          elem.innerHTML = translateKey(key);
          elem.removeAttribute('data-translate');
        });
      } else {
        console.log("translation works!");
      }
    }
    if (locale === 'en') {
      mainPage.classList.add('en');
    }
  }
  function translateKey(key, defaultValue) {
    if (!key) {
      return;
    }
    defaultValue = defaultValue || key;
    return i18nData[key] || defaultValue;
  }
  function request(link) {
    return fetch(apiURL + link, {
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      }
    }).then(function (res) {
      return res.json();
    });
  }
  function renderTabs(container) {
    container.innerHTML = "";
    var defaultTab = false;
    for (var _i2 = 0; _i2 < weekDates.length; _i2++) {
      var tab = document.createElement("div");
      tab.classList.add("results__tabs-item");
      tab.textContent = "".concat(weekDates[_i2].period);
      if (_i2 === weekNums - 1) {
        defaultTab = true;
        tab.classList.add("_active");
        weekAmount.textContent = "".concat(weekDates[_i2].prizeFund, " \u20B4");
      }
      tab.setAttribute("data-week", _i2 + 1);
      container.appendChild(tab);
    }
    var tabs = document.querySelectorAll('.results__tabs-item');
    console.log(defaultTab);
    if (!defaultTab) {
      tabs[0].classList.add("_active");
      weekAmount.textContent = "".concat(weekDates[0].prizeFund, " \u20B4");
    }
  }
  function init() {
    InitPage();
    if (window.store) {
      var state = window.store.getState();
      userId = state.auth.isAuthorized && state.auth.id || '';
    } else {
      var c = 0;
      var i = setInterval(function () {
        if (c < 50) {
          if (window.g_user_id) {
            userId = window.g_user_id;
            checkUserAuth();
            clearInterval(i);
          }
        } else {
          clearInterval(i);
        }
      }, 200);
    }
    var _iterator9 = _createForOfIteratorHelper(participateBtns),
      _step9;
    try {
      for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
        var joinBtn = _step9.value;
        joinBtn.addEventListener('click', function () {
          participate();
        });
      }
    } catch (err) {
      _iterator9.e(err);
    } finally {
      _iterator9.f();
    }
    checkUserAuth();
  }
  document.addEventListener('click', function (e) {
    var tab = e.target.closest('.results__tabs-item');
    if (!tab) return;
    var allTabs = document.querySelectorAll('.results__tabs-item');
    allTabs.forEach(function (item) {
      item.classList.remove('_active');
    });
    tab.classList.add('_active');
    var tabWeek = tab.getAttribute('data-week');
    weekAmount.textContent = "".concat(weekDates[tabWeek - 1].prizeFund, " \u20B4");
    console.log(tabWeek);
  });
  loadTranslations().then(init);
  var welcomeLogo = document.querySelector(".welcome__logo"),
    welcomeText = document.querySelector(".welcome__text"),
    welcomePrize = document.querySelector(".welcome__prize");
  setTimeout(function () {
    welcomeLogo.classList.remove("topAnimHide");
    welcomeLogo.classList.add("topAnimShow");
  }, 250);
  setTimeout(function () {
    welcomeText.classList.remove("topAnimHide");
    welcomeText.classList.add("topAnimShow");
  }, 500);
  setTimeout(function () {
    welcomePrize.classList.remove("topAnimHide");
    welcomePrize.classList.add("topAnimShow");
  }, 750);

  //test

  if (!userId) {
    document.querySelector("#results-table-other").classList.add("hide");
  }
  document.querySelector(".auth-btn").addEventListener("click", function () {
    userId = Number(sessionStorage.getItem("userId")) || 0;
    if (userId === 100300268) {
      userId = 321123321;
    } else if (userId === 321123321) {
      userId = 0;
    } else {
      userId = 100300268;
    }
    sessionStorage.setItem("userId", userId);
    window.location.reload();
  });
  document.querySelector(".dark-btn").addEventListener("click", function () {
    document.body.classList.toggle("dark");
  });
  document.querySelector(".lng-btn").addEventListener("click", function () {
    locale = locale === 'uk' ? 'en' : 'uk';
    sessionStorage.setItem("locale", locale);
    window.location.reload();
  });
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiX3Nlc3Npb25TdG9yYWdlJGdldEl0IiwiX051bWJlciIsImFwaVVSTCIsIlBST01PX1NUQVJUX0RBVEUiLCJEYXRlIiwiY3VycmVudERhdGUiLCJ3ZWVrRGF0ZXMiLCJ3ZWVrTnVtcyIsInByaXplRnVuZHMiLCJmb3JtYXREYXRlIiwiZGF0ZSIsImNvbmNhdCIsImdldERhdGUiLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwiZ2V0TW9udGgiLCJpIiwic3RhcnQiLCJnZXRUaW1lIiwiZW5kIiwic2V0SG91cnMiLCJwZXJpb2QiLCJwcml6ZUZ1bmQiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwidW5hdXRoTXNncyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInBhcnRpY2lwYXRlQnRucyIsInBsYXlCdG5zIiwibWFpblBhZ2UiLCJxdWVyeVNlbGVjdG9yIiwidGFic0NvbnRhaW5lciIsIndlZWtBbW91bnQiLCJ1a0xlbmciLCJlbkxlbmciLCJsb2NhbGUiLCJzZXNzaW9uU3RvcmFnZSIsImdldEl0ZW0iLCJpMThuRGF0YSIsInVzZXJJZCIsImRlYnVnIiwiTnVtYmVyIiwiY2hlY2tVc2VyQXV0aCIsIl9pdGVyYXRvciIsIl9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIiwiX3N0ZXAiLCJzIiwibiIsImRvbmUiLCJ1bmF1dGhNZXMiLCJ2YWx1ZSIsImNsYXNzTGlzdCIsImFkZCIsImVyciIsImUiLCJmIiwicmVxdWVzdCIsInRoZW4iLCJkYXRhIiwidXNlciIsImZpbmQiLCJ1c2VyaWQiLCJfaXRlcmF0b3IyIiwiX3N0ZXAyIiwicGxheUJ0biIsInJlbW92ZSIsIl9pdGVyYXRvcjMiLCJfc3RlcDMiLCJwYXJ0aWNpcGF0ZUJ0biIsIl9pdGVyYXRvcjQiLCJfc3RlcDQiLCJfaXRlcmF0b3I1IiwiX3N0ZXA1IiwiX2l0ZXJhdG9yNiIsIl9zdGVwNiIsIl9pdGVyYXRvcjciLCJfc3RlcDciLCJJbml0UGFnZSIsInRyYW5zbGF0ZSIsInJlbmRlclRhYnMiLCJwYXJ0aWNpcGF0ZSIsInBhcmFtcyIsImZldGNoIiwiaGVhZGVycyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVzIiwianNvbiIsIl9pdGVyYXRvcjgiLCJfc3RlcDgiLCJqb2luQnRuIiwibG9hZFRyYW5zbGF0aW9ucyIsIm11dGF0aW9uT2JzZXJ2ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zIiwib2JzZXJ2ZSIsImdldEVsZW1lbnRCeUlkIiwiY2hpbGRMaXN0Iiwic3VidHJlZSIsImVsZW1zIiwiZm9yRWFjaCIsImVsZW0iLCJrZXkiLCJnZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJ0cmFuc2xhdGVLZXkiLCJyZW1vdmVBdHRyaWJ1dGUiLCJkZWZhdWx0VmFsdWUiLCJsaW5rIiwiY29udGFpbmVyIiwiZGVmYXVsdFRhYiIsInRhYiIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwidGFicyIsImluaXQiLCJ3aW5kb3ciLCJzdG9yZSIsInN0YXRlIiwiZ2V0U3RhdGUiLCJhdXRoIiwiaXNBdXRob3JpemVkIiwiaWQiLCJjIiwic2V0SW50ZXJ2YWwiLCJnX3VzZXJfaWQiLCJjbGVhckludGVydmFsIiwiX2l0ZXJhdG9yOSIsIl9zdGVwOSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiYWxsVGFicyIsIml0ZW0iLCJ0YWJXZWVrIiwid2VsY29tZUxvZ28iLCJ3ZWxjb21lVGV4dCIsIndlbGNvbWVQcml6ZSIsInNldFRpbWVvdXQiLCJzZXRJdGVtIiwibG9jYXRpb24iLCJyZWxvYWQiLCJ0b2dnbGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUMsV0FBQUEscUJBQUEsRUFBQUMsT0FBQSxFQUFVO0VBQ1AsSUFBTUMsTUFBTSxHQUFHLHFDQUFxQztFQUVwRCxJQUFNQyxnQkFBZ0IsR0FBRyxJQUFJQyxJQUFJLENBQUMscUJBQXFCLENBQUM7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dEIsQ0FBQyxNQUFNLElBQUlBLE1BQU0sS0FBSyxTQUFTLEVBQUU7TUFDN0JBLE1BQU0sR0FBRyxDQUFDO0lBQ2QsQ0FBQyxNQUFNO01BQ0hBLE1BQU0sR0FBRyxTQUFTO0lBQ3RCO0lBRUFILGNBQWMsQ0FBQzJHLE9BQU8sQ0FBQyxRQUFRLEVBQUV4RyxNQUFNLENBQUM7SUFDeENpRixNQUFNLENBQUN3QixRQUFRLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0VBQzVCLENBQUMsQ0FBQztFQUNGeEgsUUFBUSxDQUFDSyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUN1RyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBSztJQUMvRDVHLFFBQVEsQ0FBQzRELElBQUksQ0FBQ2xDLFNBQVMsQ0FBQytGLE1BQU0sQ0FBQyxNQUFNLENBQUM7RUFDMUMsQ0FBQyxDQUFDO0VBRUZ6SCxRQUFRLENBQUNLLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQ3VHLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFNO0lBQy9EbEcsTUFBTSxHQUFHQSxNQUFNLEtBQUssSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJO0lBQ3RDQyxjQUFjLENBQUMyRyxPQUFPLENBQUMsUUFBUSxFQUFFNUcsTUFBTSxDQUFDO0lBQ3hDcUYsTUFBTSxDQUFDd0IsUUFBUSxDQUFDQyxNQUFNLENBQUMsQ0FBQztFQUM1QixDQUFDLENBQUM7QUFFTixDQUFDLEVBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7XG4gICAgY29uc3QgYXBpVVJMID0gJ2h0dHBzOi8vZmF2LXByb20uY29tL2FwaV9sdmx1cF8yMDI1JztcblxuICAgIGNvbnN0IFBST01PX1NUQVJUX0RBVEUgPSBuZXcgRGF0ZShcIjIwMjUtMDQtMTRUMTI6MDA6MDBcIik7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpXG5cbiAgICBjb25zdCB3ZWVrRGF0ZXMgPSBbXTtcbiAgICBsZXQgd2Vla051bXMgPSAwO1xuICAgIGNvbnN0IHByaXplRnVuZHMgPSBbYDMwMCAwMDBgLCBgMzAwIDAwMGAsIGA0MDAgMDAwYF07XG5cbiAgICBjb25zdCBmb3JtYXREYXRlID0gKGRhdGUpID0+IHtcbiAgICAgICAgcmV0dXJuIGAke2RhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfS4keyhkYXRlLmdldE1vbnRoKCkgKyAxKVxuICAgICAgICAgICAgLnRvU3RyaW5nKClcbiAgICAgICAgICAgIC5wYWRTdGFydCgyLCBcIjBcIil9YDtcbiAgICB9O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgbGV0IHN0YXJ0ID0gbmV3IERhdGUoUFJPTU9fU1RBUlRfREFURS5nZXRUaW1lKCkgKyBpICogNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgICAgICBsZXQgZW5kID0gbmV3IERhdGUoc3RhcnQuZ2V0VGltZSgpICsgNiAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgICAgICBlbmQuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTtcblxuICAgICAgICB3ZWVrRGF0ZXNbaV0gPSB7XG4gICAgICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IGVuZCxcbiAgICAgICAgICAgIHBlcmlvZDogYCR7Zm9ybWF0RGF0ZShzdGFydCl9IC0gJHtmb3JtYXREYXRlKGVuZCl9YCxcbiAgICAgICAgICAgIHByaXplRnVuZDogcHJpemVGdW5kc1tpXSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoY3VycmVudERhdGUgPj0gZW5kKSB7XG4gICAgICAgICAgICB3ZWVrTnVtcysrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3ZWVrRGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGN1cnJlbnREYXRlID49IHdlZWtEYXRlc1tpXS5zdGFydCAmJiBjdXJyZW50RGF0ZSA8PSB3ZWVrRGF0ZXNbaV0uZW5kKSB7XG4gICAgICAgICAgICB3ZWVrTnVtcyA9IGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHdlZWtOdW1zID09PSAwKSB7XG4gICAgICAgIGlmIChjdXJyZW50RGF0ZSA8IHdlZWtEYXRlc1swXS5zdGFydCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLQkNC60YbRltGPINGJ0LUg0L3QtSDQv9C+0YfQsNC70LDRgdGMXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLQkNC60YbRltGPINCy0LbQtSDQt9Cw0LrRltC90YfQuNC70LDRgdGMXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCLQn9C+0YLQvtGH0L3QuNC5INGC0LjQttC00LXQvdGMOlwiLCB3ZWVrTnVtcyk7XG4gICAgY29uc29sZS5sb2coXCLQlNC10YLQsNC70ZYg0YLQuNC20L3RltCyOlwiLCB3ZWVrRGF0ZXMpO1xuXG5cbiAgICBjb25zdFxuICAgICAgICB1bmF1dGhNc2dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVuYXV0aC1tc2dzJyksXG4gICAgICAgIHBhcnRpY2lwYXRlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29rLXBhcnQnKSxcbiAgICAgICAgcGxheUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxheS1idG4nKSxcbiAgICAgICAgbWFpblBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZhdi1wYWdlXCIpLFxuICAgICAgICB0YWJzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXN1bHRzX190YWJzXCIpLFxuICAgICAgICB3ZWVrQW1vdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXN1bHRzX19wcml6ZS1hbW91bnRcIik7XG5cbiAgICBjb25zdCB1a0xlbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdWtMZW5nJyk7XG4gICAgY29uc3QgZW5MZW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VuTGVuZycpO1xuXG4gICAgbGV0IGxvY2FsZSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJsb2NhbGVcIikgPz8gJ3VrJztcbiAgICAvLyBsZXQgbG9jYWxlID0gICd1ayc7XG5cbiAgICBpZiAodWtMZW5nKSBsb2NhbGUgPSAndWsnO1xuICAgIGlmIChlbkxlbmcpIGxvY2FsZSA9ICdlbic7XG5cbiAgICBsZXQgaTE4bkRhdGEgPSB7fTtcbiAgICBsZXQgdXNlcklkO1xuICAgIGNvbnN0IGRlYnVnID0gZmFsc2U7XG5cbiAgICB1c2VySWQgPSBOdW1iZXIoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInVzZXJJZFwiKSkgPz8gMTAwMzAwMjY4IDtcbiAgICAvLyB1c2VySWQgPSAxMDAzMDAyNjggO1xuXG4gICAgY29uc3QgY2hlY2tVc2VyQXV0aCA9ICgpID0+IHtcbiAgICAgICAgaWYgKHVzZXJJZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCB1bmF1dGhNZXMgb2YgdW5hdXRoTXNncykge1xuICAgICAgICAgICAgICAgIHVuYXV0aE1lcy5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXF1ZXN0KFwiL3VzZXJzXCIpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXNlciA9IGRhdGEuZmluZCh1c2VyID0+IHVzZXIudXNlcmlkID09PSB1c2VySWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwbGF5QnRuIG9mIHBsYXlCdG5zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnRpY2lwYXRlQnRuIG9mIHBhcnRpY2lwYXRlQnRucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljaXBhdGVCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0aWNpcGF0ZUJ0biBvZiBwYXJ0aWNpcGF0ZUJ0bnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYXRlQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBsYXlCdG4gb2YgcGxheUJ0bnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0aWNpcGF0ZUJ0biBvZiBwYXJ0aWNpcGF0ZUJ0bnMpIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGF0ZUJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHVuYXV0aE1lcyBvZiB1bmF1dGhNc2dzKSB7XG4gICAgICAgICAgICAgICAgdW5hdXRoTWVzLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBJbml0UGFnZSA9ICgpID0+IHtcbiAgICAgICAgY2hlY2tVc2VyQXV0aCgpXG4gICAgICAgIHRyYW5zbGF0ZSgpO1xuICAgICAgICByZW5kZXJUYWJzKHRhYnNDb250YWluZXIpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFydGljaXBhdGUoKSB7XG4gICAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwYXJhbXMgPSB7IHVzZXJpZDogdXNlcklkIH07XG4gICAgICAgIGNvbnNvbGUubG9nKHBhcmFtcylcblxuICAgICAgICBmZXRjaChhcGlVUkwgKyAnL3VzZXIvJywge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGFyYW1zKVxuICAgICAgICB9KS50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgICAgICAudGhlbihyZXMgPT4ge1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGpvaW5CdG4gb2YgcGFydGljaXBhdGVCdG5zKXtcbiAgICAgICAgICAgICAgICBqb2luQnRuLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEluaXRQYWdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvYWRUcmFuc2xhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHthcGlVUkx9L25ldy10cmFuc2xhdGVzLyR7bG9jYWxlfWApLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgICAgICAgICAudGhlbihqc29uID0+IHtcbiAgICAgICAgICAgICAgICBpMThuRGF0YSA9IGpzb247XG4gICAgICAgICAgICAgICAgdHJhbnNsYXRlKCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbHZsVXAnKSwge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyYW5zbGF0ZSgpIHtcbiAgICAgICAgY29uc3QgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10cmFuc2xhdGVdJylcbiAgICAgICAgaWYgKGVsZW1zICYmIGVsZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYoIWRlYnVnKXtcbiAgICAgICAgICAgICAgICBlbGVtcy5mb3JFYWNoKGVsZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBlbGVtLmdldEF0dHJpYnV0ZSgnZGF0YS10cmFuc2xhdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5pbm5lckhUTUwgPSB0cmFuc2xhdGVLZXkoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtdHJhbnNsYXRlJyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHJhbnNsYXRpb24gd29ya3MhXCIpXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG4gICAgICAgIGlmIChsb2NhbGUgPT09ICdlbicpIHtcbiAgICAgICAgICAgIG1haW5QYWdlLmNsYXNzTGlzdC5hZGQoJ2VuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cmFuc2xhdGVLZXkoa2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWUgfHwga2V5O1xuICAgICAgICByZXR1cm4gaTE4bkRhdGFba2V5XSB8fCBkZWZhdWx0VmFsdWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVxdWVzdCAobGluaykge1xuICAgICAgICByZXR1cm4gZmV0Y2goYXBpVVJMICsgbGluaywge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSkudGhlbihyZXMgPT4gcmVzLmpzb24oKSk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiByZW5kZXJUYWJzIChjb250YWluZXIpe1xuICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gXCJcIlxuXG5cbiAgICAgICAgbGV0IGRlZmF1bHRUYWIgPSBmYWxzZVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2Vla0RhdGVzLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgICAgY29uc3QgdGFiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKFwicmVzdWx0c19fdGFicy1pdGVtXCIpXG4gICAgICAgICAgICB0YWIudGV4dENvbnRlbnQgPSBgJHt3ZWVrRGF0ZXNbaV0ucGVyaW9kfWBcblxuICAgICAgICAgICAgaWYoaSA9PT0gd2Vla051bXMgLSAxKXtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VGFiID0gdHJ1ZVxuICAgICAgICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKVxuICAgICAgICAgICAgICAgIHdlZWtBbW91bnQudGV4dENvbnRlbnQgPSBgJHt3ZWVrRGF0ZXNbaV0ucHJpemVGdW5kfSDigrRgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRhYi5zZXRBdHRyaWJ1dGUoXCJkYXRhLXdlZWtcIiwgaSArIDEpXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGFiKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXN1bHRzX190YWJzLWl0ZW0nKVxuXG5cblxuICAgICAgICBjb25zb2xlLmxvZyhkZWZhdWx0VGFiKVxuICAgICAgICBpZighZGVmYXVsdFRhYil7XG4gICAgICAgICAgICB0YWJzWzBdLmNsYXNzTGlzdC5hZGQoXCJfYWN0aXZlXCIpXG4gICAgICAgICAgICB3ZWVrQW1vdW50LnRleHRDb250ZW50ID0gYCR7d2Vla0RhdGVzWzBdLnByaXplRnVuZH0g4oK0YFxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBJbml0UGFnZSgpO1xuICAgICAgICBpZiAod2luZG93LnN0b3JlKSB7XG4gICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHdpbmRvdy5zdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICAgICAgdXNlcklkID0gc3RhdGUuYXV0aC5pc0F1dGhvcml6ZWQgJiYgc3RhdGUuYXV0aC5pZCB8fCAnJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGMgPSAwO1xuICAgICAgICAgICAgdmFyIGkgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGMgPCA1MCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmdfdXNlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkID0gd2luZG93LmdfdXNlcl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrVXNlckF1dGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBqb2luQnRuIG9mIHBhcnRpY2lwYXRlQnRucykge1xuICAgICAgICAgICAgam9pbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHBhcnRpY2lwYXRlKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNoZWNrVXNlckF1dGgoKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHRhYiA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5yZXN1bHRzX190YWJzLWl0ZW0nKTtcbiAgICAgICAgaWYgKCF0YWIpIHJldHVybjtcbiAgICAgICAgY29uc3QgYWxsVGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXN1bHRzX190YWJzLWl0ZW0nKTtcbiAgICAgICAgYWxsVGFicy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdfYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpO1xuICAgICAgICBjb25zdCB0YWJXZWVrID0gdGFiLmdldEF0dHJpYnV0ZSgnZGF0YS13ZWVrJylcblxuICAgICAgICB3ZWVrQW1vdW50LnRleHRDb250ZW50ID0gYCR7d2Vla0RhdGVzW3RhYldlZWsgLSAxXS5wcml6ZUZ1bmR9IOKCtGBcblxuXG5cbiAgICAgICAgY29uc29sZS5sb2codGFiV2VlaylcbiAgICB9KTtcblxuICAgIGxvYWRUcmFuc2xhdGlvbnMoKVxuICAgICAgICAudGhlbihpbml0KTtcblxuICAgIGNvbnN0IHdlbGNvbWVMb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53ZWxjb21lX19sb2dvXCIpLFxuICAgICAgICAgIHdlbGNvbWVUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53ZWxjb21lX190ZXh0XCIpLFxuICAgICAgICAgIHdlbGNvbWVQcml6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VsY29tZV9fcHJpemVcIik7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICB3ZWxjb21lTG9nby5jbGFzc0xpc3QucmVtb3ZlKFwidG9wQW5pbUhpZGVcIilcbiAgICAgICAgd2VsY29tZUxvZ28uY2xhc3NMaXN0LmFkZChcInRvcEFuaW1TaG93XCIpXG4gICAgfSwgMjUwKVxuICAgIHNldFRpbWVvdXQoKCkgPT57XG4gICAgICAgIHdlbGNvbWVUZXh0LmNsYXNzTGlzdC5yZW1vdmUoXCJ0b3BBbmltSGlkZVwiKVxuICAgICAgICB3ZWxjb21lVGV4dC5jbGFzc0xpc3QuYWRkKFwidG9wQW5pbVNob3dcIilcbiAgICB9LCA1MDApXG4gICAgc2V0VGltZW91dCgoKSA9PntcbiAgICAgICAgd2VsY29tZVByaXplLmNsYXNzTGlzdC5yZW1vdmUoXCJ0b3BBbmltSGlkZVwiKVxuICAgICAgICB3ZWxjb21lUHJpemUuY2xhc3NMaXN0LmFkZChcInRvcEFuaW1TaG93XCIpXG4gICAgfSwgNzUwKVxuXG5cbiAgICAvL3Rlc3RcblxuICAgIGlmKCF1c2VySWQpe1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Jlc3VsdHMtdGFibGUtb3RoZXJcIikuY2xhc3NMaXN0LmFkZChcImhpZGVcIilcbiAgICB9XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmF1dGgtYnRuXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHVzZXJJZCA9IE51bWJlcihzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwidXNlcklkXCIpKSB8fCAwO1xuXG4gICAgICAgIGlmICh1c2VySWQgPT09IDEwMDMwMDI2OCkge1xuICAgICAgICAgICAgdXNlcklkID0gMzIxMTIzMzIxO1xuICAgICAgICB9IGVsc2UgaWYgKHVzZXJJZCA9PT0gMzIxMTIzMzIxKSB7XG4gICAgICAgICAgICB1c2VySWQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdXNlcklkID0gMTAwMzAwMjY4O1xuICAgICAgICB9XG5cbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInVzZXJJZFwiLCB1c2VySWQpO1xuICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kYXJrLWJ0blwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZShcImRhcmtcIilcbiAgICB9KVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sbmctYnRuXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGxvY2FsZSA9IGxvY2FsZSA9PT0gJ3VrJyA/ICdlbicgOiAndWsnO1xuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwibG9jYWxlXCIsIGxvY2FsZSk7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICAgIH0pO1xuXG59KCkpIl19
